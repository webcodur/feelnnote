# 셀럽 카드 게임 기획서: "영향력 대전"

> 실존 인물의 영향력 데이터로 벌이는 6라운드 전략 배치 게임.

---

## 1. 게임 개요

**장르**: 순차적 블라인드 배치 게임 (GOPS 변형)
**대전**: 1:1 vs AI
**소요 시간**: 5~10분

### 핵심 메커니즘

6개 영역(정치/전략/기술/사회/경제/문화)에 셀럽 카드를 1장씩 배치한다. 상대도 같은 영역에 1장을 배치한다. 해당 영역 점수가 높은 쪽이 점수를 얻는다. 6라운드 후 총점이 높은 쪽이 승리.

**한 줄 요약**: "이번 영역에 누구를 내보낼 것인가?"

---

## 2. v1 허점 → v2 해결

| 허점 | 해결 |
|------|------|
| 매 턴 최강 카드 내면 끝 | 카드는 1회용. 지금 강한 카드를 쓰면 나중에 없다 |
| AI 상대 가위바위보 = 운 | 행동 시스템 삭제. 상대 패를 아는 상태에서 추론 게임 |
| 드래프트가 총합 순서 픽 | 교대 드래프트. 상대 거부(deny) 전략 존재 |
| 페르소나 16개 스탯 무의미 | 영향력 6개만 사용. 나머지는 카드 비주얼 |
| 전투력 공식이 복잡 | 공식 없음. 해당 영역 점수 비교가 전부 |
| 저등급 강제 편입이 억지 | 등급 제한 없음. 저등급 특화 카드가 자연스럽게 가치 있음 |

---

## 3. 게임 규칙

### 3.1 드래프트 (덱 구성)

1. 658명 중 **12명 랜덤 제시**
   - 등급 분포: S/A 2명, B/C 4명, D/E 4명, 랜덤 2명
   - 12명 전원의 **6개 영역 점수가 공개**된 상태
2. **교대 드래프트** (스네이크 순서: P→AI→AI→P→P→AI→AI→P→P→AI→AI→P)
3. 각자 **6명** 확보 → 나의 패

드래프트에서의 판단:
- "아인슈타인(기술10, 전략9)을 내가 안 가져가면 AI가 가져간다"
- "BTS(문화8, 나머지 0~1)는 문화 특화 카드. 쓸 곳이 확실하다"
- "상대가 정치 고득점 카드를 2장 가져갔으니, 나도 정치를 방어해야 하나?"

### 3.2 대전 (6라운드)

```
1. 영역 공개: 6개 중 1개 (다음 영역도 미리보기)
2. 동시 선택: 양쪽 패에서 1장씩 비공개 선택
3. 공개: 두 카드 동시 오픈
4. 채점: 해당 영역 점수 비교 → 승자가 차이만큼 득점
5. 소멸: 사용된 카드 2장 폐기 (재사용 불가)
```

- 6개 영역은 매 게임 **랜덤 순서로 셔플**
- 각 영역은 정확히 **1번만 등장**
- 현재 영역 + 다음 영역 = 2개 정보 공개

### 3.3 채점

```
라운드 점수 = max(0, 내 영역 점수 - 상대 영역 점수)
```

- 이기면: 차이만큼 득점 (예: 10 vs 3 = 7점)
- 지면: 0점
- 동점: 능력치 타이브레이크 → 승자 1점 (아래 참조)
- **6라운드 후 총점이 높은 쪽 승리**

### 3.4 타이브레이크 (동점 시)

같은 영역 점수인 경우, 해당 영역과 연관된 **능력(Ability)** 스탯으로 판정:

| 영역 | 타이브레이크 능력 |
|------|-----------------|
| 정치 | command (통솔) |
| 전략 | martial (무력) |
| 기술 | intellect (지력) |
| 사회 | charisma (매력) |
| 경제 | command (통솔) |
| 문화 | charisma (매력) |

타이브레이크 승리 시 1점. 능력치도 동일하면 양쪽 0점.

---

## 4. 전략 분석

### 4.1 핵심 딜레마: "지금 쓸까, 아끼까"

6장의 카드로 6라운드를 치른다. 모든 카드를 정확히 1번 사용한다. 문제는 **배치 순서**.

**예시 상황:**

내 패: 칭기즈 칸, 아인슈타인, BTS, 간디, 스티브 잡스, 마키아벨리

라운드 1 영역: **전략** (다음: 기술)

- 칭기즈 칸: 전략10 → 여기서 쓰면 확실한 고득점
- 하지만 칭기즈 칸은 정치10이기도 하다. 정치 영역이 뒤에 나오면?
- 카이사르도 전략9. 칭기즈 대신 카이사르를 쓸까?... 없다. 드래프트 때 AI가 가져감
- 다음이 기술이니 아인슈타인은 아껴둬야 한다
- 상대 패에 전략 고득점자가 있나? → 드래프트 때 봤으니 추론 가능

**이게 "최강 카드 내면 끝"이 아닌 이유:**
칭기즈 칸을 전략에 쓰면 정치에서 마키아벨리(10)밖에 없다. 상대가 정치에 더 강한 카드를 가지고 있다면 정치를 포기하는 셈. 칭기즈 칸을 정치에 아끼고, 전략은 마키아벨리(9)로 버틸까? 상대도 같은 고민을 하고 있다.

### 4.2 상대 패가 공개된 이유

드래프트가 교대 픽이므로 **상대 6장을 전부 안다.**

- 운 게임이 아님: 상대 패를 모르면 "찍기"가 된다
- AI 상대에게 의미 있음: 심리전이 아니라 **추론 게임**
- "상대 패에 기술 고득점자가 없으니, 기술은 약한 카드로도 이길 수 있다"
- "상대가 문화에 베토벤을 가지고 있으니, 문화는 포기하고 다른 영역을 확보하자"

### 4.3 드래프트 전략

| 유형 | 예시 | 장점 | 단점 |
|------|------|------|------|
| 만능형 | 무함마드 (모든 영역 5+) | 어디에 내도 중간 이상 | 압도적 승리가 드묾 |
| 특화형 | BTS (문화8, 나머지 0~1) | 해당 영역에서 대승 | 나머지 영역 기여 0 |

- 만능형 6장 = 안정적이지만 큰 점수차를 내기 어렵다
- 특화형 혼합 = 강한 영역에서 대승, 약한 영역에서 대패. 총점 변동적
- **거부 픽(deny pick)**: 내가 안 써도 상대에게 안 주려고 뽑는 전략

### 4.4 AI 난이도

| 난이도 | 전략 |
|--------|------|
| 쉬움 | 현재 영역에서 가장 높은 카드를 냄 (탐욕적) |
| 보통 | 현재 + 다음 영역 2턴 앞을 고려 |
| 어려움 | 남은 전 영역을 고려한 최적 배치 계산 (미니맥스) |

어려움 AI는 실제로 강하다. GOPS의 최적 전략은 게임 이론 연구 대상이며, 완벽한 해는 없다.

---

## 5. 데이터 사용

### 5.1 게임에 사용하는 데이터

| 데이터 | 출처 | 용도 |
|--------|------|------|
| 영향력 6개 점수 | `celeb_influence` | **게임 코어.** 영역별 승패 결정 |
| 능력 4개 스탯 | `celeb_persona` | 타이브레이크 전용 |
| 통시성 | `celeb_influence` | 카드 등급 표시 (비주얼) |

### 5.2 게임에 사용하지 않는 데이터

| 데이터 | 이유 |
|--------|------|
| 품성 8개 (절제, 용기 등) | 조건부 트리거는 6라운드에서 체감 불가 |
| 성향 4개 (비관↔낙관 등) | 보정폭이 작아 결과에 영향 미미 |
| 직군 패시브 | 16종 효과는 학습 비용 대비 재미 기여 낮음 |

→ 카드 상세보기에는 전부 표시 (인물 정보로서의 가치). 게임 메커니즘에는 불개입.

### 5.3 카드 표시 정보

**드래프트 시 (전체 공개):**
```
┌──────────────────────┐
│  [A]         🇲🇳     │  등급 + 국적
│                      │
│    [아바타 이미지]     │
│                      │
│  칭기즈 칸            │
│  지휘관 · 정복자      │
│                      │
│  정 10  전 10  기 3   │  ← 6개 영역 점수 전부 공개
│  사  7  경  8  문 6   │
│                      │
│  통솔 98  무력 85     │  ← 타이브레이크용 (참고)
└──────────────────────┘
```

**대전 시 (간략):**
```
┌──────────────────────┐
│  [A] 칭기즈 칸  🇲🇳   │
│  [아바타]             │
│     전략: 10          │  ← 현재 영역 점수만 강조
└──────────────────────┘
```

---

## 6. 밸런스

### 6.1 저등급 카드의 자연스러운 가치

E등급은 대부분 현대 연예인·스포츠인. 총합은 낮지만 문화나 사회에서 고득점.

문화 영역에서 BTS(8)를 내면, 상대가 예수(문화10)를 이미 다른 영역에 썼다면 BTS가 이긴다. 등급 제한 없이도 자연스럽게 가치가 생긴다.

### 6.2 만능형 카드 견제

무함마드(정10 전9 기5 사10 경8 문9)는 어디에 내도 강하다. 하지만 6장 중 1장일 뿐. 드래프트 1순위 경쟁 대상이고, 만능형을 가져가면 특화 카드를 놓치게 된다.

### 6.3 영역 순서의 영향

6개 영역이 랜덤 순서로 나오므로, 같은 패라도 매 게임 전략이 달라진다. "다음 영역 미리보기" 덕분에 2턴 앞까지 계획 가능. 완전 운이 아닌 **제한된 정보 하의 최적화**.

---

## 7. 기술 설계

### 7.1 데이터 로딩

```typescript
const { data: celebCards } = await supabase
  .from('profiles')
  .select(`
    id, nickname, profession, title, nationality, avatar_url, quotes,
    celeb_influence!inner(
      political, strategic, tech, social, economic, cultural, transhistoricity
    ),
    celeb_persona!inner(command, martial, intellect, charisma)
  `)
  .eq('profile_type', 'CELEB');
```

### 7.2 타입

```typescript
interface BattleCard {
  id: string;
  nickname: string;
  profession: string;
  title: string;
  nationality: string;
  avatarUrl: string;
  quotes: string;
  tier: 'S' | 'A' | 'B' | 'C' | 'D' | 'E';
  influence: Record<Domain, number>;  // 0-10, 게임 코어
  ability: {                          // 0-100, 타이브레이크 전용
    command: number;
    martial: number;
    intellect: number;
    charisma: number;
  };
}

type Domain = 'political' | 'strategic' | 'tech' | 'social' | 'economic' | 'cultural';

interface GameState {
  phase: 'draft' | 'battle' | 'result';
  domainOrder: Domain[];        // 셔플된 6개 영역
  currentRound: number;         // 0-5
  playerHand: BattleCard[];     // 남은 패
  aiHand: BattleCard[];
  playerScore: number;
  aiScore: number;
  rounds: RoundResult[];
}

interface RoundResult {
  domain: Domain;
  playerCard: BattleCard;
  aiCard: BattleCard;
  playerDomainScore: number;
  aiDomainScore: number;
  pointsAwarded: { player: number; ai: number };
}
```

### 7.3 파일 구조

```
sw/web/src/
├── app/(main)/rest/battle/
│   └── page.tsx                    # 게임 페이지
│
├── components/features/game/battle/
│   ├── BattleGame.tsx              # 게임 컨테이너 (phase 라우팅)
│   ├── DraftPhase.tsx              # 교대 드래프트 UI
│   ├── BattlePhase.tsx             # 6라운드 대전 UI
│   ├── BattleCard.tsx              # 카드 컴포넌트
│   ├── DomainReveal.tsx            # 영역 공개 연출
│   ├── RoundResult.tsx             # 라운드 결과 연출
│   ├── GameResult.tsx              # 최종 결과
│   └── hooks/
│       └── useBattleGame.ts        # 상태 관리
│
├── lib/game/
│   ├── gameEngine.ts               # 채점, 타이브레이크
│   ├── aiPlayer.ts                 # AI 난이도별 로직
│   ├── deckBuilder.ts              # 12명 풀 생성 (등급 분포)
│   └── types.ts
│
└── actions/game/
    └── getCelebCards.ts            # DB 조회 서버 액션
```

---

## 8. 구현 우선순위

| 순서 | 항목 | 산출물 |
|------|------|--------|
| 1 | 데이터 로딩 + 카드 UI | getCelebCards, BattleCard |
| 2 | 드래프트 | DraftPhase (12명 풀, 교대 픽) |
| 3 | 대전 코어 | BattlePhase (영역 공개 → 선택 → 채점) |
| 4 | AI (쉬움) | 탐욕적 AI (현재 영역 최강 카드) |
| 5 | 결과 화면 | GameResult (총점, 라운드별 리플레이) |
| 6 | AI (보통/어려움) | 2턴 예측 / 미니맥스 AI |
| 7 | 연출 | 카드 오픈 애니메이션, 점수 카운트 |

---

## 9. 풀 시뮬레이션 예시

### 드래프트 결과

**나**: 칭기즈 칸, 아인슈타인, BTS, 간디, 스티브 잡스, 마키아벨리
**AI**: 무함마드, 카이사르, 뉴턴, 베토벤, 넬슨 만델라, 마르크스

### 영역 순서 (셔플)

① 전략 → ② 문화 → ③ 정치 → ④ 기술 → ⑤ 사회 → ⑥ 경제

### 라운드별

**R1: 전략** (다음: 문화)
```
칭기즈 칸(10) vs 무함마드(9) → 나 +1
판단: 칭기즈 칸은 정치10이기도 하지만, 마키아벨리(정치10)가 있으니 여기서 사용.
```

**R2: 문화** (다음: 정치)
```
잡스(5) vs 베토벤(10) → AI +5
판단: AI에 베토벤(문화10)이 있어 이길 수 없다. 약한 카드를 버린다.
```

**R3: 정치** (다음: 기술)
```
BTS(1) vs 카이사르(10) → AI +9
판단: 마키아벨리(정치10)를 내도 카이사르(10)와 동점, 타이브레이크에서
      command 38 vs 95로 진다. 차라리 BTS를 버리고 마키아벨리를 후반에 아낀다.
```

**R4: 기술** (다음: 사회)
```
아인슈타인(10) vs 뉴턴(10) → 동점 → intellect 98 vs 95 → 나 +1 (타이브레이크)
```

**R5: 사회** (다음: 경제)
```
간디(9) vs 만델라(9) → 동점 → charisma 78 vs 80 → AI +1
```

**R6: 경제**
```
마키아벨리(5) vs 마르크스(8) → AI +3
```

### 최종

| R | 영역 | 나 | AI | 나 | AI |
|---|------|----|----|----|----|
| 1 | 전략 | 칭기즈 칸(10) | 무함마드(9) | **1** | 0 |
| 2 | 문화 | 잡스(5) | 베토벤(10) | 0 | **5** |
| 3 | 정치 | BTS(1) | 카이사르(10) | 0 | **9** |
| 4 | 기술 | 아인슈타인(10) | 뉴턴(10) | **1** | 0 |
| 5 | 사회 | 간디(9) | 만델라(9) | 0 | **1** |
| 6 | 경제 | 마키아벨리(5) | 마르크스(8) | 0 | **3** |
| | | | **합계** | **2** | **18** |

**AI 압승.**

### 복기

드래프트에서 문화·정치 방어 카드가 부족했다. 칭기즈 칸/아인슈타인/마키아벨리가 전략·기술·정치에 겹치는 반면, 문화를 커버할 카드가 BTS뿐이었다. 드래프트에서 베토벤을 거부 픽하거나, 문화가 강한 카드를 더 가져왔어야 했다.

→ **이런 복기가 가능한 게임 = 재플레이 동기가 있는 게임.**
