# 유저 프로필 (타인 방문)

## 개요

다른 유저의 기록관을 방문하여 공개된 문화생활을 탐색하는 기능. 피드에서 관심 가는 유저를 발견했을 때 자연스럽게 프로필로 이동하여 더 많은 기록을 확인할 수 있다.

> **현재 상태**: 기획 단계

---

## 라우팅

| 경로 | 설명 |
|------|------|
| `/user/[userId]` | 타인 프로필 메인 (기록관) |
| `/user/[userId]/playlists` | 타인의 플레이리스트 목록 |
| `/user/[userId]/playlists/[id]` | 타인의 플레이리스트 상세 |

---

## 진입점

| 위치 | 동작 |
|------|------|
| 피드 카드 | 아바타/닉네임 클릭 → 프로필 이동 |
| 콘텐츠 상세 피드 | 작성자 클릭 → 프로필 이동 |
| 검색 결과 | 유저 검색 → 프로필 이동 |
| 팔로워/팔로잉 목록 | 유저 클릭 → 프로필 이동 |
| 댓글 | 댓글 작성자 클릭 → 프로필 이동 |

---

## 화면 구성

### 프로필 헤더

```
┌─────────────────────────────────────────────┐
│                                             │
│  [아바타]  닉네임                            │
│           @username                         │
│                                             │
│  자기소개 텍스트 (있는 경우)                  │
│                                             │
│  📚 123 기록  👥 45 팔로워  👤 32 팔로잉     │
│                                             │
│  [팔로우] 또는 [팔로잉 ✓]                    │
│                                             │
└─────────────────────────────────────────────┘
```

### 콘텐츠 영역

```
┌─────────────────────────────────────────────┐
│ [전체] [도서] [영화] [게임] [음악]           │
├─────────────────────────────────────────────┤
│                                             │
│  ┌────┐ ┌────┐ ┌────┐ ┌────┐              │
│  │    │ │    │ │    │ │    │              │
│  │표지│ │표지│ │표지│ │표지│              │
│  │    │ │    │ │    │ │    │              │
│  └────┘ └────┘ └────┘ └────┘              │
│  제목    제목    제목    제목               │
│  ★4.5   ★4.0   ★5.0   진행중              │
│                                             │
│  ┌────┐ ┌────┐ ┌────┐ ┌────┐              │
│  │    │ │    │ │    │ │    │              │
│  ...                                        │
│                                             │
└─────────────────────────────────────────────┘
```

---

## 본인 vs 타인 비교

| 항목 | 본인 (`/archive`) | 타인 (`/user/[id]`) |
|------|-------------------|---------------------|
| 헤더 제목 | "내 기록관" | "{닉네임}의 기록관" |
| 프로필 정보 | ❌ (별도 페이지) | ✅ 헤더에 표시 |
| 팔로우 버튼 | ❌ | ✅ |
| 콘텐츠 추가 | ✅ | ❌ |
| 플레이리스트 생성 | ✅ | ❌ |
| 편집/삭제 | ✅ | ❌ |
| 콘텐츠 범위 | 전체 | visibility 기반 필터링 |

---

## 공개 범위 (Visibility)

### 접근 권한 매트릭스

| visibility | 본인 | 팔로워 | 비팔로워 |
|------------|------|--------|----------|
| `public` | ✅ | ✅ | ✅ |
| `followers` | ✅ | ✅ | ❌ |
| `private` | ✅ | ❌ | ❌ |

### 적용 대상

| 대상 | visibility 적용 |
|------|-----------------|
| 기록 (리뷰/노트) | ✅ 개별 설정 |
| 플레이리스트 | ✅ 개별 설정 |
| 콘텐츠 목록 | 기록이 있는 것만 표시 |

### 비공개 처리 UI

```
┌─────────────────────────────────────────────┐
│                                             │
│  🔒 비공개 기록관                            │
│                                             │
│  이 유저는 기록을 공개하지 않았습니다.        │
│                                             │
│  [팔로우하기]                               │
│                                             │
└─────────────────────────────────────────────┘
```

---

## 팔로우 기능

### 상태

| 상태 | 버튼 | 동작 |
|------|------|------|
| 미팔로우 | `[팔로우]` | 팔로우 추가 |
| 팔로잉 | `[팔로잉 ✓]` | 클릭 시 언팔로우 확인 |
| 맞팔 | `[친구 ✓]` | 상호 팔로우 표시 |
| 차단됨 | - | 프로필 접근 불가 |

### 언팔로우 확인

```
┌─────────────────────────────────────────────┐
│                                             │
│  {닉네임}님을 언팔로우할까요?                │
│                                             │
│  팔로워 공개 기록을 더 이상 볼 수 없습니다.   │
│                                             │
│  [취소]              [언팔로우]              │
│                                             │
└─────────────────────────────────────────────┘
```

---

## 차단 기능

### 차단 시 동작

| 항목 | 동작 |
|------|------|
| 프로필 접근 | 차단 메시지 표시 |
| 피드 노출 | 상대방 기록 미노출 |
| 검색 결과 | 상대방 미노출 |
| 팔로우 관계 | 자동 해제 |

### 차단 화면

```
┌─────────────────────────────────────────────┐
│                                             │
│  🚫 차단된 유저                              │
│                                             │
│  이 유저의 프로필을 볼 수 없습니다.           │
│                                             │
│  [차단 해제]                                │
│                                             │
└─────────────────────────────────────────────┘
```

---

## 필요 API

### 조회

| API | 설명 |
|-----|------|
| `getUserProfile(userId)` | 유저 프로필 정보 |
| `getUserContents(userId)` | 유저의 공개 콘텐츠 목록 |
| `getUserPlaylists(userId)` | 유저의 공개 플레이리스트 |
| `getFollowStatus(userId)` | 팔로우 상태 확인 |

### 액션

| API | 설명 |
|-----|------|
| `followUser(userId)` | 팔로우 |
| `unfollowUser(userId)` | 언팔로우 |
| `blockUser(userId)` | 차단 |
| `unblockUser(userId)` | 차단 해제 |

---

## 데이터 모델

### profiles (확장)

| 필드 | 타입 | 설명 |
|------|------|------|
| id | UUID | PK |
| nickname | TEXT | 닉네임 |
| avatar_url | TEXT | 프로필 이미지 |
| bio | TEXT | 자기소개 (신규) |
| is_public | BOOLEAN | 기록관 전체 공개 여부 (신규) |

### user_social (기존)

| 필드 | 타입 | 설명 |
|------|------|------|
| user_id | UUID | PK |
| follower_count | INT | 팔로워 수 |
| following_count | INT | 팔로잉 수 |
| friend_count | INT | 맞팔 수 |

---

## 컴포넌트 구조

```
/user/[userId]/page.tsx
└── UserProfileView
    ├── UserProfileHeader
    │   ├── Avatar
    │   ├── UserInfo (닉네임, 소개)
    │   ├── SocialStats (기록, 팔로워, 팔로잉)
    │   └── FollowButton
    └── ContentLibrary (기존 재사용)
        ├── props.userId 추가
        └── visibility 필터링 적용
```

---

## 구현 우선순위

### Phase 1: MVP

- [ ] 유저 프로필 페이지 (`/user/[userId]`)
- [ ] 프로필 헤더 컴포넌트
- [ ] 공개 콘텐츠 조회 API
- [ ] visibility 필터링

### Phase 2: 소셜

- [ ] 팔로우/언팔로우 기능
- [ ] 팔로워 전용 콘텐츠 접근
- [ ] 피드 카드에서 프로필 링크

### Phase 3: 확장

- [ ] 차단 기능
- [ ] 유저 검색
- [ ] 프로필 자기소개 편집

---

*07_유저_프로필.md - 최종 수정: 2024.12*
