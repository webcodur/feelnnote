# 02. 캐릭터 시스템

## 동적 로딩 원칙

캐릭터는 **게임 시작 시 DB에서 동적으로 로딩**한다.
사전에 하드코딩하지 않으며, DB에 셀럽이 추가되면 자동으로 게임에 반영된다.

### 로딩 조건

```sql
SELECT p.*, ci.*
FROM profiles p
JOIN celeb_influence ci ON ci.celeb_id = p.id
WHERE p.death_date IS NOT NULL
  AND p.death_date != ''
  AND (연도 환산) <= (현재연도 - 120)
```

- 사망일이 현재로부터 120년 이전인 인물만 포함
- 영향력 평가(`celeb_influence`)가 완료된 인물만 포함
- 현재 기준 약 148명, 지속 증가 예정

---

## 기본 스탯 (6개)

DB `celeb_influence` 테이블에서 직접 매핑한다.

| 게임 스탯 | DB 컬럼 | 범위 | 용도 |
|----------|---------|------|------|
| **무력 (武)** | `strategic` | 0-10 | 근접 전투력, 돌격 대미지 |
| **기술 (技)** | `tech` | 0-10 | 원거리 공격, 공성, 건설 속도 |
| **지략 (智)** | `political` | 0-10 | 계략, 외교 성공률, 도술 |
| **덕망 (德)** | `social` | 0-10 | 영입 성공률, 사기 유지, 방어 |
| **경영 (經)** | `economic` | 0-10 | 자원 생산, 교역 효율 |
| **문화 (文)** | `cultural` | 0-10 | 문화 영향력, 민심, 특수 건물 |

### 파생 스탯

| 파생 스탯 | 공식 | 설명 |
|----------|------|------|
| **체력 (HP)** | `transhistoricity × 2.5` (0-100) | 전투 생존력 |
| **통솔** | `max(무력, 지략)` | 지휘 가능 병력 수 |
| **매력** | `(덕망 + 문화) / 2` | 영입 보너스, 민심 |
| **총합** | 6스탯 합산 | 캐릭터 등급 기준 |

---

## 등급

DB total_score 기반 자동 분류.

| 등급 | total_score | 색상 | 예시 |
|------|------------|------|------|
| **SS** | 75+ | 금색 | 무함마드, 구텐베르크, 아리스토텔레스 |
| **S** | 65-74 | 보라 | 칭기즈 칸, 나폴레옹, 링컨, 다윈 |
| **A** | 55-64 | 파랑 | 뉴턴, 다빈치, 칸트, 이순신 |
| **B** | 45-54 | 초록 | 도스토옙스키, 베토벤, 비스마르크 |
| **C** | 35-44 | 흰색 | 반 고흐, 오스틴, 니체 |
| **D** | 25-34 | 회색 | 이이, 박지원, 리처드 1세 |
| **E** | 0-24 | 갈색 | 이덕무, 에밀리 브론테 |

---

## 병과

`profession` 기반 자동 분류. 병과별 전투 특성이 다르다.

| 병과 | 아이콘 | 해당 직군 | 전투 특성 |
|------|--------|----------|----------|
| **장수 (將)** | 검 | commander, leader, athlete | 근접 특화, HP 보너스, 돌격 가능 |
| **책사 (策)** | 부채 | humanities_scholar, social_scientist | 계략 특화, 도술 사용, 원거리 |
| **장인 (匠)** | 망치 | scientist, entrepreneur, investor | 공성 특화, 건설 보너스, 함정 |
| **관료 (官)** | 인장 | politician | 외교 특화, 내정 보너스, 수비 |
| **예인 (藝)** | 붓 | author, musician, visual_artist, director, actor | 사기 버프, 문화 특화, 회복 |
| **유격 (遊)** | 표창 | influencer, other | 정찰, 교란, 빠른 이동 |

### 병과별 전투 보너스

| 병과 | 공격 보너스 | 방어 보너스 | 특수 |
|------|-----------|-----------|------|
| 장수 | 무력 ×1.5 | HP +20% | 돌격: 첫 턴 대미지 2배 |
| 책사 | 지략 ×1.5 | - | 계략: 매 턴 계략 시전 가능 |
| 장인 | 기술 ×1.5 | - | 공성: 성벽 대미지 3배 |
| 관료 | - | 방어 ×1.5 | 수비: 성벽 위 방어력 2배 |
| 예인 | - | - | 고무: 인접 아군 사기 +10/턴 |
| 유격 | - | - | 기습: 선제공격, 이동력 +1 |

---

## 영입 시스템

### 방랑 인재

게임 시작 시, 플레이어/AI 세력에 소속되지 않은 인재들은 맵 위에 방랑 상태로 존재한다.

### 영입 조건

```
영입 확률 = 기본 30%
  + (주군 매력 × 3%)
  + (제안 금화 × 0.5%)
  + (같은 국적 보너스 10%)
  + (아이템 선물 보너스)
  - (대상 덕망 × 2%)  // 덕망 높은 인물은 까다로움
```

### 특수 영입

- **의기투합**: 같은 콘텐츠(아이템)를 보유한 주군 → 영입 확률 +20%
- **삼고초려**: 3턴 연속 방문 시 영입 확률 +30%
- **항복 장수**: 전투 패배 후 포로 → 등용 제안 가능

---

## 캐릭터 표시 정보

게임 내에서 표시할 DB 필드:

| 표시 | DB 필드 | 예시 |
|------|---------|------|
| 이름 | `nickname` | 칭기즈 칸 |
| 수식어 | `title` | 몽골 제국의 건국자 |
| 초상화 | `avatar_url` / `portrait_url` | (없으면 병과 기본 아이콘) |
| 국적 깃발 | `nationality` | MN 🇲🇳 |
| 생몰년 | `birth_date` ~ `death_date` | 1162 ~ 1227 |
| 소개 | `bio` | 몽골 통일 후 유라시아 대제국... |
| 명언 | `quotes` | 전투 시 대사로 활용 |
